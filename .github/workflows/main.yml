name: Run Stock News Bot

on:
  schedule:
    # 30분마다 실행 (원하는 시간으로 변경 가능)
    # 15분마다 하려면 '*/15 * * * *'
    - cron: '8,28,48 * * * *'
  workflow_dispatch: # 수동 실행 버튼 활성화

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install feedparser tweepy requests
        pip install pillow
        # font.ttf 파일이 없으면 설치가 의미가 없으니 꼭 업로드하세요!

    - name: Run bot
      env:
        # Settings > Secrets에 저장된 키들을 불러옵니다
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        CONSUMER_KEY: ${{ secrets.CONSUMER_KEY }}
        CONSUMER_SECRET: ${{ secrets.CONSUMER_SECRET }}
        ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
        ACCESS_TOKEN_SECRET: ${{ secrets.ACCESS_TOKEN_SECRET }}
      run: |
        python -u bot.py